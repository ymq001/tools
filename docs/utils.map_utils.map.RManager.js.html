<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>utils.map/utils.map.RManager.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="utils.html">utils</a><ul class='methods'><li data-type='method'><a href="utils.html#isObject">isObject</a></li><li data-type='method'><a href="utils.html#isArray">isArray</a></li><li data-type='method'><a href="utils.html#isDate">isDate</a></li><li data-type='method'><a href="utils.html#isNumber">isNumber</a></li><li data-type='method'><a href="utils.html#isInteger">isInteger</a></li><li data-type='method'><a href="utils.html#isString">isString</a></li><li data-type='method'><a href="utils.html#isBoolean">isBoolean</a></li><li data-type='method'><a href="utils.html#isFunction">isFunction</a></li><li data-type='method'><a href="utils.html#isNull">isNull</a></li><li data-type='method'><a href="utils.html#isNil">isNil</a></li><li data-type='method'><a href="utils.html#isPlainObject">isPlainObject</a></li><li data-type='method'><a href="utils.html#hasOwn">hasOwn</a></li><li data-type='method'><a href="utils.html#unique">unique</a></li><li data-type='method'><a href="utils.html#extend">extend</a></li><li data-type='method'><a href="utils.html#freeze">freeze</a></li><li data-type='method'><a href="utils.html#copy">copy</a></li><li data-type='method'><a href="utils.html#getKeyValue">getKeyValue</a></li><li data-type='method'><a href="utils.html#setKeyValue">setKeyValue</a></li><li data-type='method'><a href="utils.html#toArray">toArray</a></li><li data-type='method'><a href="utils.html#toObject">toObject</a></li><li data-type='method'><a href="utils.html#uuid">uuid</a></li><li data-type='method'><a href="utils.html#getBrowser">getBrowser</a></li><li data-type='method'><a href="utils.html#getUriParams">getUriParams</a></li><li data-type='method'><a href="utils.html#getUriParamValue">getUriParamValue</a></li><li data-type='method'><a href="utils.html#saveLocal">saveLocal</a></li><li data-type='method'><a href="utils.html#getLocal">getLocal</a></li><li data-type='method'><a href="utils.html#getLocal2Json">getLocal2Json</a></li><li data-type='method'><a href="utils.html#removeLocal">removeLocal</a></li><li data-type='method'><a href="utils.html#saveCookie">saveCookie</a></li><li data-type='method'><a href="utils.html#getCookie">getCookie</a></li><li data-type='method'><a href="utils.html#removeCookie">removeCookie</a></li><li data-type='method'><a href="utils.html#clearCookie">clearCookie</a></li></ul></li><li><a href="utils.date.html">date</a><ul class='methods'><li data-type='method'><a href="utils.date.html#.format">format</a></li><li data-type='method'><a href="utils.date.html#.modDays">modDays</a></li><li data-type='method'><a href="utils.date.html#.modMinutes">modMinutes</a></li><li data-type='method'><a href="utils.date.html#.convertDateToTimeStamp">convertDateToTimeStamp</a></li><li data-type='method'><a href="utils.date.html#.convertTimeStampToDate">convertTimeStampToDate</a></li></ul></li><li><a href="utils.QT.html">QT</a><ul class='methods'><li data-type='method'><a href="utils.QT.html#.showLoading">showLoading</a></li></ul></li><li><a href="socket.html">socket</a><ul class='methods'><li data-type='method'><a href="socket.html#send">send</a></li><li data-type='method'><a href="socket.html#close">close</a></li><li data-type='method'><a href="socket.html#on">on</a></li><li data-type='method'><a href="socket.html#off">off</a></li></ul></li><li><a href="utils.map.default.html">default</a><ul class='members'><li data-type='member'><a href="utils.map.default.html#._map">_map</a></li><li data-type='member'><a href="utils.map.default.html#.'Org'">'Org'</a></li><li data-type='member'><a href="utils.map.default.html#.'Rcu'">'Rcu'</a></li><li data-type='member'><a href="utils.map.default.html#.'Network'">'Network'</a></li><li data-type='member'><a href="utils.map.default.html#.'RingNet'">'RingNet'</a></li><li data-type='member'><a href="utils.map.default.html#.'Robot'">'Robot'</a></li><li data-type='member'><a href="utils.map.default.html#.'Smd'">'Smd'</a></li><li data-type='member'><a href="utils.map.default.html#.'70220002'">'70220002'</a></li><li data-type='member'><a href="utils.map.default.html#.'70220003'">'70220003'</a></li><li data-type='member'><a href="utils.map.default.html#.'70220004'">'70220004'</a></li></ul><ul class='methods'><li data-type='method'><a href="utils.map.default.html#.getIcon">getIcon</a></li><li data-type='method'><a href="utils.map.default.html#.setIcon">setIcon</a></li></ul></li><li><a href="utils.map.html">map</a><ul class='methods'><li data-type='method'><a href="utils.map.html#.initialize">initialize</a></li></ul></li><li><a href="utils.map.RData.html">RData</a><ul class='methods'><li data-type='method'><a href="utils.map.RData.html#initialize">initialize</a></li><li data-type='method'><a href="utils.map.RData.html#refreshDefaults">refreshDefaults</a></li><li data-type='method'><a href="utils.map.RData.html#_convertAttrs">_convertAttrs</a></li><li data-type='method'><a href="utils.map.RData.html#dataTreeToTable">dataTreeToTable</a></li><li data-type='method'><a href="utils.map.RData.html#dataListToTable">dataListToTable</a></li><li data-type='method'><a href="utils.map.RData.html#getDataBykey">getDataBykey</a></li><li data-type='method'><a href="utils.map.RData.html#getOnlyDataBykey">getOnlyDataBykey</a></li><li data-type='method'><a href="utils.map.RData.html#getDatas">getDatas</a></li></ul></li><li><a href="utils.map.RManager.html">RManager</a><ul class='methods'><li data-type='method'><a href="utils.map.RManager.html#addOverlay">addOverlay</a></li><li data-type='method'><a href="utils.map.RManager.html#addOverlays">addOverlays</a></li><li data-type='method'><a href="utils.map.RManager.html#addOverlaysFromList">addOverlaysFromList</a></li><li data-type='method'><a href="utils.map.RManager.html#removerOverlay">removerOverlay</a></li><li data-type='method'><a href="utils.map.RManager.html#removeOverlays">removeOverlays</a></li><li data-type='method'><a href="utils.map.RManager.html#removeViewingOverlay">removeViewingOverlay</a></li><li data-type='method'><a href="utils.map.RManager.html#removeViewingOverlays">removeViewingOverlays</a></li><li data-type='method'><a href="utils.map.RManager.html#clearOverlays">clearOverlays</a></li><li data-type='method'><a href="utils.map.RManager.html#clearViewingOverlays">clearViewingOverlays</a></li><li data-type='method'><a href="utils.map.RManager.html#getViewingOverlaysByZoom">getViewingOverlaysByZoom</a></li><li data-type='method'><a href="utils.map.RManager.html#show">show</a></li><li data-type='method'><a href="utils.map.RManager.html#hide">hide</a></li><li data-type='method'><a href="utils.map.RManager.html#toggle">toggle</a></li><li data-type='method'><a href="utils.map.RManager.html#getOverlayBykey">getOverlayBykey</a></li><li data-type='method'><a href="utils.map.RManager.html#getOverlays">getOverlays</a></li></ul></li><li><a href="utils.map.RMarker.html">RMarker</a><ul class='methods'><li data-type='method'><a href="utils.map.RMarker.html#_preRenderContent">_preRenderContent</a></li><li data-type='method'><a href="utils.map.RMarker.html#_convertThemeToString">_convertThemeToString</a></li><li data-type='method'><a href="utils.map.RMarker.html#_renderPresetStyles">_renderPresetStyles</a></li><li data-type='method'><a href="utils.map.RMarker.html#enableDragging">enableDragging</a></li><li data-type='method'><a href="utils.map.RMarker.html#disableDragging">disableDragging</a></li><li data-type='method'><a href="utils.map.RMarker.html#isDraggable">isDraggable</a></li><li data-type='method'><a href="utils.map.RMarker.html#getPosition">getPosition</a></li><li data-type='method'><a href="utils.map.RMarker.html#setPosition">setPosition</a></li><li data-type='method'><a href="utils.map.RMarker.html#getAnchor">getAnchor</a></li><li data-type='method'><a href="utils.map.RMarker.html#setAnchor">setAnchor</a></li><li data-type='method'><a href="utils.map.RMarker.html#getContent">getContent</a></li><li data-type='method'><a href="utils.map.RMarker.html#setContent">setContent</a></li><li data-type='method'><a href="utils.map.RMarker.html#getWidth">getWidth</a></li><li data-type='method'><a href="utils.map.RMarker.html#setWidth">setWidth</a></li><li data-type='method'><a href="utils.map.RMarker.html#getHeight">getHeight</a></li><li data-type='method'><a href="utils.map.RMarker.html#setHeight">setHeight</a></li><li data-type='method'><a href="utils.map.RMarker.html#on">on</a></li><li data-type='method'><a href="utils.map.RMarker.html#off">off</a></li></ul></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-MapDesc.html">MapDesc</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">utils.map/utils.map.RManager.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>(function (utils) {
  utils.map = utils.map = utils.map || {};
  
  
  /*** utils.map.RManager 代码开始 ***/
  /**
   * utils.map.RManager类的构造函数
   * @class
   * @alias utils.map.RManager
   * @classdesc utils.map.RManager
   * @description 自定义点聚合，实现按组织聚合的效果。 {@link http://172.26.1.40/docs/examples/rmanager.html|RManager示例} &lt;br />
   * 实现缓存机制，首屏只加载可视区域内的覆盖物 &lt;br />
   * 实现根据自定义属性过滤覆盖物效果 &lt;br />
   * 实现根据预设的覆盖物缩放级别范围显隐覆盖物
   * 
   * @constructor
   * 
   * @property {BMap.Map} _map 百度地图BMap的实例
   * @property {Array} _overlays 需要被管理起来的overlay列表
   * @property {Boolean} _visible 控制显隐所有覆盖物，默认false 不显示所有的覆盖物
   * @property {Function} _filter 数据过滤函数，默认不做处理，直接返回 true
   * @property {Number} padding 可视区域的外填充，默认 0
   * @property {Number} minZoom 地图最大缩放级别，默认 6
   * @property {Number} maxZoom 地图最小缩放级别，默认 16
   * 
   * @param {BMap.Map} map 百度地图BMap的实例
   * @param {Json} opts 可选参数,非必要选项
   * @param {Number} opts.padding 可视区域的外填充，默认 0
   * @param {Number} opts.minZoom 地图最大缩放级别，默认 6
   * @param {Number} opts.maxZoom 地图最小缩放级别，默认 16
   * @param {Function} opts.filter 数据过滤函数，必须返回boolean类型的值
   * 
   * @return {Boolean}
   * 
   * @example 参考示例：
   * var map = new BMap.Map("container");
   * map.centerAndZoom(new BMap.Point(116.309965, 40.058333), 17);
   * var rmanager = new utils.map.RManager(map, {
   *  padding: 50,
   *  minZoom: 8,
   *  maxZoom: 16
   * });
   */
  utils.map.RManager = function (map, opts) {
    if (!(map instanceof BMap.Map)) {
      console.warn('请传递正确的BMap的实例');
      return false;
    }
    opts = opts || {};

    this._map = utils.map.default._map = map;
    this.padding = utils.map.tools.isNumber(opts.padding) ? opts.padding : 0;
    this.minZoom = utils.map.tools.isNumber(opts.minZoom) ? opts.minZoom : 6;
    this.maxZoom = utils.map.tools.isNumber(opts.maxZoom) ? opts.maxZoom : 16;
    this._filter = utils.map.tools.isFunction(opts.filter) ? opts.filter : function () { return true; };
    this._overlays = [];  //用于存放overlay列表
    this._visible = false;//控制显隐所有覆盖物

    //注册拖拽和缩放事件
    var _this = this;
    this._map.addEventListener('zoomend', function () {
      _this.show();
    });
    this._map.addEventListener('dragend', function () {
      _this.show();
    });
    return true;
  }
  /**
   * 添加单个overlay(覆盖物)
   * @param {BMap.Overlay} overlay 需要添加到地图上的覆盖物
   * @param {Json} opts 必要参数
   * @param {Number} opts.minZoom 必要参数 覆盖物可以被显示的地图最小缩放级别，默认取地图最小缩放级别
   * @param {Number} opts.maxZoom 必要参数 覆盖物可以被现实的地图最大缩放级别，默认取地图最大缩放级别
   * @return {Boolean}
   */
  utils.map.RManager.prototype.addOverlay = function (overlay, opts) {
    if (!(overlay instanceof BMap.Overlay)) {
      console.warn('请传递正确的覆盖物实例对象');
      return false;
    }

    opts = opts || {};
    overlay.attrs = overlay.attrs || {};
    overlay.attrs.minZoom = overlay._opts.attrs.minZoom = utils.map.tools.isNumber(opts.minZoom) ? opts.minZoom : (overlay._opts.attrs.minZoom || this.minZoom);
    overlay.attrs.maxZoom = overlay._opts.attrs.maxZoom = utils.map.tools.isNumber(opts.maxZoom) ? opts.maxZoom : (overlay._opts.attrs.maxZoom || this.maxZoom);
    overlay.attrs._isAdded = false;     //当前覆盖物是否已经添加到地图上
    overlay.attrs._isVisible = false;   //当前覆盖物是否被显示
    overlay.attrs._isInViewing = false; //当前覆盖物位置是否在可视区域内

    this._overlays.push(overlay);
    return true;
  }
  /**
   * 批量添加相同缩放级别范围中的overlay(覆盖物)
   * @param {Array&lt;BMap.Overlay>} overlays 需要添加到地图上的覆盖物列表
   * @param {Json} opts 必要参数
   * @param {Number} opts.minZoom 必要参数 覆盖物可以被显示的地图最小缩放级别，默认取地图最小缩放级别
   * @param {Number} opts.maxZoom 必要参数 覆盖物可以被现实的地图最大缩放级别，默认取地图最大缩放级别
   */
  utils.map.RManager.prototype.addOverlays = function (overlays, opts) {
    if (overlays instanceof Array) {
      for (var i = 0, _overlay; _overlay = overlays[i]; i++) {
        this.addOverlay(_overlay, opts);
      }
      this.show();
    }
  }
  /**
   * 批量添加相同缩放级别范围中的overlay(覆盖物)  --- 测试阶段
   * @param {Array} list 需要添加到地图上的覆盖物数据列表
   * @param {Number} list.x RMarker坐标 经度
   * @param {Number} list.y RMarker坐标 纬度
   * @param {Json|String|HTMLElement} list.content 自定义marker内容，可以是Json对象( eg: {url: {String}, size: {BMap.Size}} )，可以是字符串，也可以是dom节点
   * @param {String} list.content.url marker背景图标链接
   * @param {BMap.Size} list.content.size marker背景图标大小
   * @param {BMap.Size} list.anchor Marker的的位置偏移值
   * @param {Boolean} list.enableDragging 是否启用拖拽，默认为false
   * @param {Boolean} list.isShowText 是否显示marker名称，默认为true
   * @param {Boolean} list.isShowCount 是否显示marker角标，默认为false
   * @param {Boolean} list.count marker角标，可以是数字，也可以是文本
   * @param {String} list.text marker名称
   * @param {Json} list.countTheme 角标主题色
   * @param {String} list.countTheme.bgColor 浏览器可以识别的颜色值，默认半透明黑色
   * @param {String} list.countTheme.color 浏览器可以识别的颜色值，默认白色
   * @param {Json} list.textTheme marker名称主题色
   * @param {String} list.textTheme.bgColor 浏览器可以识别的颜色值，默认半透明黑色
   * @param {String} list.textTheme.color 浏览器可以识别的颜色值，默认白色
   * @param {Json} list.attrs 存放自定义属性
   * 
   * @param {Json} opts 必要参数
   * @param {Number} opts.minZoom 必要参数 覆盖物可以被显示的地图最小缩放级别，默认取地图最小缩放级别
   * @param {Number} opts.maxZoom 必要参数 覆盖物可以被现实的地图最大缩放级别，默认取地图最大缩放级别
   */
  utils.map.RManager.prototype.addOverlaysFromList = function (list, opts) {
    if (list instanceof Array) {
      for (var i = 0, _item, _overlay; _item = list[i]; i++) {
        var _opts = utils.extend(true, {}, );
        _overlay = new utils.map.RMarker(new BMap.Point(_item.x, _item.y), _item.content, {
          anchor: _item.anchor,
          enableDragging: _item.enableDragging,
          isShowText: _item.isShowText,
          isShowCount: _item.isShowCount,
          count: _item.count,
          text: _item.text,
          countTheme: _item.countTheme,
          textTheme: _item.textTheme,
          attrs: _item.attrs
        });
        this.addOverlay(_overlay, opts);
      }
      this.show();
    }
  }
  /**
   * 移除单个覆盖物，不管覆盖物是否在可视区域内
   * &lt;span style="color:red">此方法执行后覆盖物将从dom文档中删除 &lt;/span>
   * @param {BMap.Overlay} overlay 需要被移除的覆盖物
   * @return {Boolean} 
   */
  utils.map.RManager.prototype.removerOverlay = function (overlay) {
    if (!(overlay instanceof BMap.Overlay)) {
      console.warn('请传递正确的覆盖物实例对象');
      return false;
    }
    this._map.removerOverlay(overlay);    //移除地图上的覆盖物
    this._removeOverlayFromList(overlay); //移除缓存的覆盖物列表中的覆盖物
    return true;
  }
  /**
   * 批量移除overlay(覆盖物)，不管覆盖物是否在可视区域内
   * &lt;span style="color:red">此方法执行后覆盖物将从dom文档中删除 &lt;/span>
   * @param {Array&lt;BMap.Overlay>} overlays 需要被移除的覆盖物列表
   */
  utils.map.RManager.prototype.removeOverlays = function (overlays) {
    if (overlays instanceof Array) {
      for (var i = 0, _overlay; _overlay = overlays[i]; i++) {
        this.removerOverlay(_overlay);
      }
    }
  }
  /**
   * 移除可视区域内单个覆盖物
   * 若覆盖物不再可视区域内,则不执行移除方法
   * &lt;span style="color:red">此方法执行后覆盖物将从dom文档中删除 &lt;/span>
   * @param {BMap.Overlay} overlay 需要被移除的覆盖物
   * @return {Boolean} 
   */
  utils.map.RManager.prototype.removeViewingOverlay = function (overlay) {
    if (!(overlay instanceof BMap.Overlay)) {
      console.warn('请传递正确的覆盖物实例对象');
      return false;
    }
    if (!overlay.attrs._isInViewing) return false; //当前覆盖物不再可视区域内,直接返回false
    this._map.removerOverlay(overlay);    //移除地图上的覆盖物
    this._removeOverlayFromList(overlay); //移除缓存的覆盖物列表中的覆盖物
    return true;
  }
  /**
   * 批量可视区域内覆盖物
   * 若覆盖物列表中的覆盖物不在可视区域内，则不执行移除方法
   * &lt;span style="color:red">此方法执行后覆盖物将从dom文档中删除 &lt;/span>
   * @param {Array&lt;BMap.Overlay>} overlays 需要被移除的覆盖物列表
   */
  utils.map.RManager.prototype.removeViewingOverlays = function (overlays) {
    if (overlays instanceof Array) {
      for (var i = 0, _overlay; _overlay = overlays[i]; i++) {
        this.removeViewingOverlay(_overlay);
      }
    }
  }
  /**
   * 清除所有覆盖物
   */
  utils.map.RManager.prototype.clearOverlays = function () {
    for (var i = 0, _overlay; _overlay = this._overlays[i]; i++) {
      this._map.removeOverlays(_overlay);
    }
    this._overlays = [];
  }
  /**
   * 清除可视区域内所有覆盖物
   */
  utils.map.RManager.prototype.clearViewingOverlays = function () {
    var _overlaylist = [];
    for (var i = 0, _overlay; _overlay = this._overlays[i]; i++) {
      if (_overlay.attrs._isInViewing) {
        this._map.removeOverlays(_overlay);
      } else {
        _overlaylist.push(_overlay);
      }
    }
    this._overlays = _overlaylist;
  }
  /**
   * 从覆盖物缓存列表中移除指定的覆盖物
   * @private
   * @param {BMap.Overlay} overlay 需要被移除的覆盖物
   */
  utils.map.RManager.prototype._removeOverlayFromList = function (overlay) {
    for (var i = this._overlays.length - 1; i > 0; i--) {
      if (this._overlays[i] === overlay) {
        this._overlays.splice(i, 1);
        break;
      }
    }
  }
  /**
   * 获取可视范围内的覆盖物列表
   * @param {Number} zoom 需要检测的地图缩放级别
   * @return {Array} 返回当前缩放级别下可视区域内的覆盖物列表
   */
  utils.map.RManager.prototype.getViewingOverlaysByZoom = function (zoom) {
    var _overlaylist = [];
    if (this._visible) {
      for (var i = 0, _overlay; _overlay = this._overlays[i]; i++) {
        if (_overlay.attrs._isInViewing &amp;&amp; _overlay.attrs.minZoom &lt;= zoom &amp;&amp; _overlay.attrs.maxZoom >= zoom) {
          _overlaylist.push(_overlay);
        }
      }
    }
    return _overlaylist;
  }
  /**
   * 显示可视区内覆盖物
   * 此方法通过操作元素display属性实现显隐的目的
   * @param {Function} filter 可选，过滤覆盖物的函数钩子，必须返回boolean类型的值，默认为RManager的属性_filter
   */
  utils.map.RManager.prototype.show = function (filter) {
    filter = utils.map.tools.isFunction(filter) ? filter : this._filter;
    this._visible = true;
    this._toggleOverlays(filter);
  }
  /**
   * 隐藏可视区内覆盖物
   * 此方法通过操作元素display属性实现显隐的目的
   * @param {Function} filter 可选，过滤覆盖物的函数钩子，必须返回boolean类型的值，默认为RManager的属性_filter
   */
  utils.map.RManager.prototype.hide = function (filter) {
    filter = utils.map.tools.isFunction(filter) ? filter : this._filter;
    this._visible = false;
    this._toggleOverlays(filter);
  }
  /**
   * 切换可视区内覆盖物的显隐
   * 此方法通过操作元素display属性实现显隐的目的
   * @param {Function} filter 可选，过滤覆盖物的函数钩子，必须返回boolean类型的值，默认为RManager的属性_filter
   */
  utils.map.RManager.prototype.toggle = function (filter) {
    this._visible ? this.hide(filter) : this.show(filter);
  }
  /**
   * 切换显隐覆盖物
   * @private
   * @param {Function} filter 可选，过滤覆盖物的函数钩子，必须返回boolean类型的值，默认为RManager的属性_filter
   */
  utils.map.RManager.prototype._toggleOverlays = function (filter) {
    var _zoom = this._map.getZoom();
    var _bounds = this._getRealBounds();
    filter = utils.map.tools.isFunction(filter) ? filter : this._filter;
    for (var i = 0, _overlay; _overlay = this._overlays[i]; i++) {
      //判断是否在可视区域内  &amp;&amp;  判断当前缩放级别是否符合覆盖物的缩放级别显示范围
      if (_bounds.containsPoint(_overlay.getPosition()) &amp;&amp; _zoom >= _overlay.attrs.minZoom &amp;&amp; _zoom &lt;= _overlay.attrs.maxZoom) {
        _overlay.attrs._isInViewing = true;
        if (!_overlay.attrs._isAdded) {
          this._map.addOverlay(_overlay);
          _overlay.attrs._isAdded = true;
          !this._visible &amp;&amp; _overlay.hide();
        } else {
          if (filter(_overlay)) {
            this._visible ? _overlay.show() : _overlay.hide();
          } else {
            _overlay.hide();
          }
        }
      } else if (_overlay.attrs._isAdded) {
        _overlay.attrs._isInViewing = false;
        _overlay.hide();
      }
    }
  }
  /**
   * 获取真实的可视区域范围
   * @private
   * @return {BMap.Bounds}
   */
  utils.map.RManager.prototype._getRealBounds = function () {
    var _bounds = this._map.getBounds();
    var _sw = this._map.pointToPixel(_bounds.getSouthWest());
    var _ne = this._map.pointToPixel(_bounds.getNorthEast());
    return new BMap.Bounds(
      this._map.pixelToPoint({
        x: _sw.x - this.padding,
        y: _sw.y + this.padding
      }),
      this._map.pixelToPoint({
        x: _ne.x + this.padding,
        y: _ne.y - this.padding
      })
    );
  }
  /**
   * 获取指定属性与之匹配的覆盖物
   * @param {String|Number} value 需要查找的指定属性值
   * @param {String} key 可选，需要查找的指定属性，默认为 id
   * @return {BMap.Overlay|undefined}
   */
  utils.map.RManager.prototype.getOverlayBykey = function (value, key) {
    var returns = undefined;
    if (!utils.map.tools.isString(key)) key = 'id';
    for (var i = 0, _overlay; _overlay = this._overlays[i]; i++) {
      if (_overlay.attrs[key] == value) {
        returns = _overlay;
        break;
      }
    }
    return returns;
  }
  /**
   * 获取自定义过滤函数匹配的覆盖物列表
   * @param {Function} filter 可选 自定义过滤函数
   * @return {Array} 返回匹配的覆盖物列表
   */
  utils.map.RManager.prototype.getOverlays = function (filter) {
    var _overlaylist = [];
    if (!utils.map.tools.isFunction(filter)) {
      filter = function () { return true; }
    }
    for (var i = 0, _overlay; _overlay = this._overlays[i]; i++) {
      if (filter(_overlay)) {
        _overlaylist.push(_overlay);
      }
    }
    return _overlaylist;
  }
  /*** utils.map.RManager 代码结束 ***/
})(window.utils || (window.utils = {}))</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri Nov 16 2018 11:21:56 GMT+0800 (中国标准时间) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/jquery-3.1.1.min.js"></script>

<script src="scripts/search.js"></script>




</body>
</html>
